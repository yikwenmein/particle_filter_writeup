# particle_filter_writeup
## My Understanding of how particle filters work

A vehicle equiped with range finder sensors and a GPS has been kidnapped and kept in an environment whose map is known to this vehicle.This map has landmarks with known positions. We then randomly simulate a given number of particles whose position(x, y, theta) is govern by a nornmal distribution with mean from a GPS reading( GPS is not very accurate in giving position estimates) with some standard deviation values(0.3, 0.3,0.01 respectively for  x, y, theta). Each of these particles is given control input( velocity and yaw_rate turn angle) by the simulator same as that contolling the vehicle. At each point in time, we are able to keep track of the vehicle's position (x, y, theta)in the actual map coordinate system. 
    As the vehicle moves inside this map, it will be able to read distances to nearby landmarks with the aid of it's onboard sensors although these distances to landmarks read by vehicle will be in the car's local coordinate system not in the global map coordinate system where x points to the direction of the car's heading and y rotated from x by +90degrees or y is perpendicular to the left of x. So in this case, we need to do some form of transformation with these measurements.I have to call your attention here becuase this will not be very straight forward as one may think but I think this is the part which really makes `Particle Filters` what they are. `Take Note here`; the car's sensor's measurements gotten which are readings of car's sensors to landmarks will actually be taken and assigned or given  to each of the randomly simulated particle. We are taking car's sensor's measurements of landmarks and giving them or assigning to each of the particles as if it were the particles that had sensed these measurements or as if each particle now has got range finder sensors on them which they can get landmark informtion through them and for me, I think it's the biggest trick in this project.
    The good thing with this approach is that we know each particle's location in maps coordinate system and adding this location to the particle's transformed observation to landmarks(assigned to it from car's reading of landmarks) as can be seen on the homogenous transformation matrix below, 
  ![Screenshot]()
From here now, we can then associate each paticle's `xm,ym` values to a certain landmark position which will be read from the `map_data.txt` file. The beauty of the landamark association is that at the time when the vehicle sensed the distances to it's nearest landmark, there were some particles were close or almost at the location where the vehicle is. So the transformed `xm,ym` for such a particle or particles will be very to a certain landmark coordinate values. So in an ideal case, the the transfromed `xm,ym` for some particle will exactly match the landmark coordinates for which the vehicle's onboard sensors got `xc,yc` from. Some of the particle's transformed `xm,ym` will be so off from the sensed landmark coordinates. This then bring us to another concept on the project call weights. Particle's whose transformed observations closely or exactly matches landmark coordinates will be given `higher weights` while those whose transformed `xm,ym` will be so off from the sensed landmark coordinates are given `lower weights`. Weights are assighed to particles based on how well their transformed `xm,ym` matches landmark coordinates that were sensed by vehicle's onboard sensors.Generally, this weight update process is done  `Multivariate-Gaussian probability density` function which looks like this


-Recall that for this example the standard deviation for both x and y is 0.3
-x and y are the transformed observations`(xm,ym)` which are given in the map coordinate system.
-μx and μy are the coordinates of the nearest landmarks

The last thing now to do is resample particles after weights update. The basic idea here is just that particles with higher weights will be drawn while those with smaller weights are left left out.Resampling is the technique used to randomly drawing new particles from the set of `updated weights` particles with replacement in proportion to their importance weights. After resampling, particles with higher weights likely to stay and all others may die out.
    All that said above can be broken down into the following steps;
1. `Initialisation step`: At the initialization step we estimate our position from GPS input. The subsequent steps in the process will refine this estimate to localize our vehicle.
2. `Prediction step`: During the prediction step we add the control input (yaw rate & velocity) for all particles.
3. `Update step`: During the update step, we update our particle weights using map landmark positions and feature measurements.
4. `Resample step`: During resampling we will resample M times (M is range of 0 to length_of_particleArray) drawing a particle i (i is the particle index) proportional to its weight . Resampling wheel is used at this step.
